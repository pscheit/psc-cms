<?php

use \Psc\TPl\TPL,
    \Psc\Doctrine\Helper as DoctrineHelper,
    \Psc\JS\jQuery,
    \Psc\JS\Code as JSCode,
    \Psc\JS\Helper as JSHelper,
    \Psc\CMS\Auth
;
$em = DoctrineHelper::em();

$tabs = new Psc\UI\ContentTabs(array());
$items = array();

//$items[] = $em->getReference('Entities\Speaker',8);
//$item = \Entities\Game::factory()->setProduct($product);
//$items[] = $em->getReference('Entities\Game',15)->setProduct($product);

//$item = new \tiptoi\NumbersTabsItem($product);
//$item = \Entities\Sound::load(1353)->setProduct($product);

//$item = new \tiptoi\MatrixExportTabsItem($product);
//$item = \Entities\Sound::load(1290)->setProduct($product);

//$item = $em->getReference('Entities\Speaker',1)->setProduct($product);
//$item = \Entities\Sound::load(193)->setProduct($product);
//$item = \Entities\Sound::load(1469)->setProduct($product);
//$item = \Entities\Sound::load(394)->setProduct($product);
//$item = new \tiptoi\SearchSpeakerTabsItem($product);
//$item = \Entities\Speaker::factory()->setProduct($product);
//$item = \Entities\Speaker::factory()->setProduct($product);

//$item = new \tiptoi\SearchOIDTabsItem($product);
//$items[] = \Entities\OID::load(13134)->setProduct($product);
//$items[] = \Entities\OID::factory()->setProduct($product);
//$items[] = new \Psc\UI\ControllerCallTabsItem('sound','leichen','Sound-Leichen-Keller',array('productId'=>$product->getIdentifier()));

//$items[] = \Entities\Sound::factory()->setProduct($product);
//$items[] = \Entities\Product::load(5);

//for ($i = 12; $i <= 22; $i++) {
//  $items[] = \Psc\CMS\Controller\TabsContentItemController::call(
//  $em->getReference('Entities\Game',$i)->setProduct($product), 'table.edit'
//                            );
//}


if (count($items) > 0 && Auth::instance()->getUser()->getEmail() == 'p.scheit@ps-webforge.com') {
  foreach ($items as $item)  {
    $tabs->addItem($item);
    $id = implode('-',$item->getTabsId());
  }
}

print $tabs->html();

if (isset($id)) {
  print jQuery::onWindowLoad(sprintf("$('#content #tabs').tabs('select','#%s')", $id));
}